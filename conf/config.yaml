# conf/config.yaml
defaults:
  - _self_
  - experiment: gpqa  # ğŸ”¥ åœ¨è¿™é‡Œä¸€é”®åˆ‡æ¢æ•°æ®é›†ï¼(å¯¹åº” conf/experiment/math_to_hmmt.yaml)
  - optimizer: default        # ğŸ”¥ åœ¨è¿™é‡Œåˆ‡æ¢ä¼˜åŒ–ç­–ç•¥

timestamp: "${now:%Y%m%d_%H%M%S}"

# ================= è·¯å¾„é…ç½® =================
paths:
  root: "/root/workspace/jychen/ex"
  jsonl: "${paths.root}/outputs/jsonl"
  png: "${paths.root}/outputs/png"
  # ä¸­é—´äº§ç‰©è·¯å¾„é…ç½®ä¿æŒä¸å˜...
  cluster_output: "${paths.jsonl}/${experiment.tag}_clustered_result.jsonl"
  cluster_summary: "${paths.jsonl}/${experiment.tag}_cluster_summary.jsonl"
  cluster_plot: "${paths.png}/${experiment.tag}_cluster_distribution.png"
  cluster_vis: "${paths.png}/${experiment.tag}_visualization.png"
  freq_file: "${paths.root}/${experiment.tag}_memory_freq.jsonl"
  freq_after_file: "${paths.root}/${experiment.tag}_memory_freq.jsonl"
  optimized_memory: "${paths.root}/${experiment.tag}_optimized_memory_topk.jsonl"
  rag_cache_dir: "${paths.root}/rag_result_cache"

# ================= æ•°å­¦å¸¸æ•° =================
parameters:
  bemr_lambda1: 1.0  # å†å²æ•ˆç”¨æƒé‡
  bemr_lambda2: 0.5  # æ¢ç´¢/ä¸ç¡®å®šæ€§æƒé‡ (è°ƒå¤§æ­¤å€¼å¯ä¿æŠ¤ä½é¢‘è®°å¿†)
# ================= æ¨¡å‹é…ç½® =================
model:
  source: "sglang" 
  optimize: "sglang"
  hf_name: "Qwen/Qwen3-4B-Instruct-2507"
  device: "cuda"
  batch_size: 20
  max_input_len: 4096
  max_new_tokens: 2048
  start_index: 0
  debug_num: 10 # è°ƒè¯•æ—¶è®¾å°ä¸€ç‚¹

  
  gemini_name: "gemini-2.5-flash"
  sglang_api_url: "http://127.0.0.1:30000/v1"
  sglang_model_name: "Qwen/Qwen3-4B-Instruct-2507"
  embedding_name: "BAAI/bge-large-en-v1.5"

# ================= èšç±»é…ç½® (ç›¸å¯¹ç¨³å®š) =================
cluster:
  method: "agglomerative"
  distance_threshold: 1.0
  kmeans_n_clusters: 10
  vis_method: "tsne"
  enable_pca_preprocess: True
  pca_preprocess_dims: 50
  tsne_perplexity: 40